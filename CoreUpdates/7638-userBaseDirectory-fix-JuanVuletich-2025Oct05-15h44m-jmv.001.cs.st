'From Cuis7.5 [latest update: #7637] on 5 October 2025 at 3:46:24 pm'!

!DirectoryEntry class methodsFor: 'base directories' stamp: 'jmv 10/5/2025 15:46:20'!
userBaseDirectory
	"The top directory for files generated by the system on behalf of the user
		userBaseDirectory/SavedChangeSets 						Folder for saving new ChangeSets
		userBaseDirectory/Packages: 								Folder for new code packages
		userBaseDirectory/UserChanges: 							Folder to store user changes files
		userBaseDirectory/FileOuts: 								Folder for filed out code
		userBaseDirectory/Logs: 									Folder for error logs and other logs
	DirectoryEntry userBaseDirectory
	See #cuisBaseDirectory. See #currentDirectory."

	UserBaseDirectory notNil ifTrue: [
		^ UserBaseDirectory ].

	self workingDirectory ifNotNil: [ :wd |
		"Don't use / as the UserBaseDirectory, as most likely we don't have rights to write to it.
		This could happen if a proper #workingDirectory is not set by the host os, for instance because
		Cuis was started from drag and drop in an os file explorer tool."
		wd isRoot ifFalse: [
			UserBaseDirectory := wd ]].

	"If no OS current directory, use a sibling of #cuisBaseDirectory
	If OS current directory is same as #cuisBaseDirectory, take a sibling too"
	(UserBaseDirectory isNil or: [ UserBaseDirectory = self cuisBaseDirectory ]) ifTrue: [
		UserBaseDirectory := self cuisBaseDirectory parent / (self cuisBaseDirectory name, '-UserFiles').
		UserBaseDirectory assureExistence ].

	^ UserBaseDirectory! !

